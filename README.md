# Задание "Локализация"
 
Данный репозитории содержит реализацию домашнего задания по теме "Локализация".

Клиентское приложение находится в папке `packages/config-server-ui`.

Ответы на вопросы:

- Как приложение узнает, какой язык выбран у пользователя?
    
    Приложение узнает про язык из URL. Т.е. ко всем путям добавлены текущий язык (к примеру, `/ru/settings`).
    Если указывается адрес без языка, то язык берется из `navigator.language`.
    
- Какие типы контента поддерживают переключение языка и как вы это реализовали
    
    Весь статический контент (т.е. который не приходит с сервера на конкретном языке), а также даты и продолжительность.
    Для переключения языка использовалась библиотека `react-intl` (компоненты и хуки из нее).
    При переключении происходит переход на URL, соответствующий другому языку, и в `react-intl` загружает новый json файл (через require).
    
- Как переводы попадают на клиент? как изменилась сборка приложения?
    
    Переводы находятся в папке `\packages\config-server-ui\src\locales` в различных json файлах.
    Изначально переводы существуют только для английского языка, остальные языки переводятся на сайте https://gitlocalize.com/repo/4632


## Установка

Репозиторий предоставляет из себя монорепозиторий, для управления используется lerna.

- Установить Node.js версии 12.6.0

- Установить все зависимости `npm install`

- Нужно создать в папке `packages/config-server` файл `server.env` (пример содержимого можно найти в `server.env.example`). 
  В нем нужно указать токен доступа к API базы, токен можно получить на странице https://hw.shri.yandex/
  
- Нужно создать в папке `packages/build-server` файл `server-conf.json` (пример содержимого можно найти в `server-conf.example.json`). 
  В нем нужно указать токен доступа к API базы (из предыдущего пункта)
  
- Сгенерировать ключи для пушей с помощью команды `npx web-push generate-vapid-keys` 
и записать их в два конфига: `packages/build-server/server-conf.json` и `packages/config-server-ui/src/push.config.js` 
(пример `push.config.js` лежит в той же директории в файле `push.config.example.js`)

## Доступные команды

- `npm run config-server` - запустить сервер настроек.

- `npm run config-server-ui` - запустить UI для сервера настроек, доступный по адресу http://localhost:3000/).

- `npm run build-server` - запустить билд-сервер, обрабатывающий очередь билдов. 
  Также настройки можно задать в файле `packages/build-server/server-conf.json`.
  
- `npm run build-agent [-- --port=1234]` - запустить билд-агента, опциональный параметр задает его порт.
  Также настройки можно задать в файле `packages/build-agent/agent-conf.json`.
